:PROPERTIES:
:ID:       ebf588e5-e1e2-4cc0-8b4d-9caf9b3b6cde
:END:
#+title: 原子中断

很多处理器在进入中断处理程序前，都会自动地将全局中断使能关上，这是因为如果不自动关上中断，那么中断触发信号会一直都在，那么处理器会反复执行硬件中断处理流程（比如反复调到异常入口函数处）。

所以硬件处理的第一步就是将全局使能关上，这样才可以正常地进入异常处理流程。之所以要全局禁用而不是仅禁用当前中断，这是因为同时可能存在多个中断，禁用一个中断有可能不顶用。

进入软件中断处理流程后，软件会首先回应当前正在处理的中断源，中断源受到信号后会关闭中断信号。但是并不会立刻打开全局中断使能，这是因为打开后如果有新的中断到来，那么就会打断原来的中断处理程序，破坏了原本的中断[[id:3efde90e-931e-458e-8a09-c448d0a2ffa1][上下文]]。

因为这种关中断的特性，所以在中断执行的开始的开始部分代码是“原子性”的，即不可被打断的。而当全局中断使能被打开时，中断又变成可以被打断了。以此为界限划分处了[[id:777afd6e-9d97-4fce-b918-187177ede007][中断上下半部]] 。
